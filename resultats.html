<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vos Résultats et Programmes Recommandés</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #f4f7f6;
            color: #333;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 20px auto;
        }
        .section {
            background-color: #ffffff;
            padding: 30px 40px;
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.08);
            margin-bottom: 25px;
        }
        .header {
            text-align: center;
            border-bottom: 1px solid #eee;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        h1, h2, h3 {
            color: #2c3e50;
        }
        h1 { font-size: 2.2rem; color: #007bff; }
        h2 { text-align: center; font-size: 1.8rem; margin-bottom: 30px; }
        h3 { color: #007bff; }

        .results-summary {
            display: flex;
            justify-content: space-around;
            text-align: center;
            margin-bottom: 30px;
        }
        .result-box {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            width: 45%;
        }
        .result-box h3 { margin-top: 0; color: #555; font-size: 1rem; }
        .result-value { font-size: 2.8em; font-weight: 700; color: #2c3e50; }
        .unit { font-size: 1rem; color: #777; }

        .program-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 25px;
        }
        .card {
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        .card:hover {
            transform: translateY(-8px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.12);
        }
        .card-content {
            flex-grow: 1;
        }
        .card-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-top: 0;
            margin-bottom: 10px;
        }
        .card-details {
            font-size: 0.95rem;
            color: #555;
            margin-bottom: 15px;
        }
        .card-price {
            font-size: 1.8rem;
            font-weight: 700;
            color: #28a745;
            margin-bottom: 15px;
        }
        .buy-button {
            display: block;
            background-color: #ff7f50;
            color: white !important;
            padding: 12px 20px;
            text-align: center;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 700;
            margin-top: auto;
            transition: background-color 0.3s;
        }
        .buy-button:hover {
            background-color: #e66a3d;
        }
        #no-loss-goal {
            background-color: #fffbe6;
            border: 1px solid #ffe58f;
        }
    </style>
</head>
<body>

    <div class="container">
        <div class="section header">
            <h1>Vos Résultats Personnalisés</h1>
            <div class="results-summary">
                <div class="result-box">
                    <h3>Métabolisme de Base</h3>
                    <p class="result-value" id="bmr-result">0</p>
                    <p class="unit">Calories / jour</p>
                </div>
                <div class="result-box">
                    <h3>Maintien du Poids</h3>
                    <p class="result-value" id="tdee-result">0</p>
                    <p class="unit">Calories / jour</p>
                </div>
            </div>
            <p>Ce besoin journalier est la base pour définir votre stratégie. Pour perdre du poids, vous devez consommer moins que ce montant.</p>
        </div>

        <div class="section" id="main-recommendation-section">
            <h2>Votre Programme Idéal Pour Démarrer</h2>
            <div id="recommended-program-container" class="program-cards">
                </div>
        </div>

        <div class="section" id="complete-challenge-section">
             <h2>Notre Recommandation Phare : Le Défi Complet</h2>
            <div id="challenge-7-weeks-container" class="program-cards">
                </div>
        </div>

        <div class="section" id="other-options-section">
            <h2>Toutes Nos Options Pour la Perte de Poids</h2>
            <div id="other-programs-container" class="program-cards">
                </div>
        </div>

        <div class="section" id="no-loss-goal">
            <h2>Un autre objectif en tête ?</h2>
            <p>Nos programmes sont optimisés pour la <strong>perte de poids</strong>. Si votre objectif est de <strong>maintenir votre poids</strong> ou de faire une <strong>prise de masse</strong>, nous vous recommandons de viser respectivement <strong id="maintenance-goal">0</strong> ou <strong id="gain-goal">0</strong> calories.</p>
            <p>Contactez-nous pour un plan personnalisé ou restez à l'écoute pour nos futurs programmes !</p>
        </div>
    </div>

    <script>
        // --- BASE DE DONNÉES DES PROGRAMMES ---
        const programs = [
            { id: 1, name: "10 jours pour sécher", price: "10,99€", calories: 1300, duration: "10 jours", description: "Idéal pour un démarrage rapide et une perte de poids visible en peu de temps.", link: "#LIEN_PRODUIT_1" },
            { id: 2, name: "14 jours pour sécher", price: "14,99€", calories: 1300, duration: "14 jours", description: "Prolongez l'effort pour des résultats plus consolidés avec ce plan efficace.", link: "#LIEN_PRODUIT_2" },
            { id: 3, name: "Défi 14 jours", price: "14,99€", calories: 1400, duration: "14 jours", description: "Un équilibre parfait entre un apport calorique modéré et une perte de poids efficace.", link: "#LIEN_PRODUIT_3" },
            { id: 4, name: "Challenge 4 semaines", price: "19,99€", calories: 1500, duration: "4 semaines", description: "Un plan sur un mois pour transformer votre silhouette de manière durable.", link: "#LIEN_PRODUIT_4" },
            { id: 5, name: "Challenge 7 semaines", price: "29,99€", calories: "Variable", duration: "7 semaines", description: "La solution la plus complète avec une variation de calories pour décupler les résultats et éviter la stagnation.", link: "#LIEN_PRODUIT_5" }
        ];

        // --- FONCTION POUR CRÉER UNE CARTE HTML ---
        function createProgramCard(program) {
            return `
                <div class="card">
                    <div class="card-content">
                        <h3 class="card-title">${program.name}</h3>
                        <p class="card-details">
                            <strong>Calories :</strong> ${program.calories === 'Variable' ? 'Progressives' : program.calories + ' kcal/jour'}<br>
                            <strong>Durée :</strong> ${program.duration}
                        </p>
                        <p>${program.description}</p>
                    </div>
                    <div class="card-price">${program.price}</div>
                    <a href="${program.link}" class="buy-button">Choisir ce programme</a>
                </div>
            `;
        }
        
        // --- LOGIQUE PRINCIPALE AU CHARGEMENT DE LA PAGE ---
        window.addEventListener('load', function() {
            const params = new URLSearchParams(window.location.search);
            const bmr = parseInt(params.get('bmr'));
            const tdee = parseInt(params.get('tdee'));

            // Sécurité : si les données sont absentes, on retourne à l'accueil.
            if (isNaN(tdee)) {
                window.location.href = 'index.html';
                return;
            }

            // 1. Afficher les résultats BMR et TDEE
            document.getElementById('bmr-result').textContent = bmr;
            document.getElementById('tdee-result').textContent = tdee;

            // 2. Déterminer les programmes à recommander
            let recommendedIds = [];
            if (tdee >= 1600 && tdee < 1800) {
                recommendedIds = [1, 2]; // Programmes à 1300 kcal
            } else if (tdee >= 1800 && tdee < 2000) {
                recommendedIds = [3];    // Programme à 1400 kcal
            } else if (tdee >= 2000) {
                recommendedIds = [4];    // Programme à 1500 kcal
            } else { // tdee < 1600
                recommendedIds = [1];    // On recommande le plus court pour commencer
            }
            
            // 3. Afficher les différentes sections de programmes
            const recommendedContainer = document.getElementById('recommended-program-container');
            const challengeContainer = document.getElementById('challenge-7-weeks-container');
            const otherContainer = document.getElementById('other-programs-container');

            // Vider les conteneurs pour éviter les duplications si le code est exécuté plusieurs fois
            recommendedContainer.innerHTML = '';
            challengeContainer.innerHTML = '';
            otherContainer.innerHTML = '';

            // Construire les listes de programmes
            const recommendedPrograms = programs.filter(p => recommendedIds.includes(p.id));
            const challengeProgram = programs.find(p => p.id === 5);
            const otherPrograms = programs.filter(p => !recommendedIds.includes(p.id) && p.id !== 5);

            // Afficher les programmes recommandés
            if (recommendedPrograms.length > 0) {
                recommendedPrograms.forEach(program => {
                    recommendedContainer.innerHTML += createProgramCard(program);
                });
            } else {
                 document.getElementById('main-recommendation-section').style.display = 'none';
            }
            
            // Toujours afficher le challenge de 7 semaines
            challengeContainer.innerHTML = createProgramCard(challengeProgram);

            // Afficher les autres programmes
            if (otherPrograms.length > 0) {
                otherPrograms.forEach(program => {
                    otherContainer.innerHTML += createProgramCard(program);
                });
            } else {
                // S'il n'y a pas d'autres programmes, on cache la section
                document.getElementById('other-options-section').style.display = 'none';
            }


            // 4. Mettre à jour la section "Autre objectif"
            document.getElementById('maintenance-goal').textContent = `${tdee} kcal`;
            document.getElementById('gain-goal').textContent = `${tdee + 300} kcal`;
        });
    </script>

</body>
</html>
